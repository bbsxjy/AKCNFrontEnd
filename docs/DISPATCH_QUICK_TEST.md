# 应用派发功能 - 快速测试步骤

## 🚀 快速测试（5分钟）

### 1. 启动应用
```bash
npm run dev
```

### 2. 执行派发
1. 打开浏览器，访问应用
2. 点击左侧菜单"应用管理"
3. 勾选任意1个应用（确保该应用有子任务）
4. 点击右上角"批量派发 (1)"按钮
5. 保持默认设置：
   - 派发方式：开发负责人
   - 派发给：**测试管理员**（当前登录用户）
   - 发送系统通知：勾选
6. 点击"确认派发"

### 3. 查看结果

#### 3.1 检查成功提示
页面右上角应显示：
```
✅ 成功派发 1 个应用 | 👤 开发负责人: 测试管理员 | 📧 已发送系统通知
```

#### 3.2 查看控制台日志
按F12打开开发者工具，Console标签页应显示：
```
🔧 使用Mock模式派发应用
🔄 正在派发应用: XXX - XXX
✅ 已更新应用 XXX 的开发负责人为: 测试管理员
📋 应用 XXX 有 N 个子任务需要更新负责人
  ✅ 已更新子任务 xxx 的开发负责人为: 测试管理员
  ...
🎉 派发完成: 成功更新 1 个应用，N 个子任务
✅ 已发送通知给 测试管理员
💡 提示: 测试管理员 可在"我的任务"页面查看新分配的任务
```

### 4. 查看"我的任务"
1. 点击左侧菜单"我的任务"
2. **方式A**: 等待30秒自动刷新
3. **方式B**: 点击右上角"刷新"按钮（推荐）
4. 应该能看到刚才派发的任务出现在列表中

### 5. 查看通知
在"我的任务"页面顶部，应该看到蓝色通知框：
```
ℹ️ 您有 1 条新的任务派发通知

**您有新的任务派发**
您被分配了 1 个应用的开发任务，请及时查看并填写进展。
[刚刚]

[标记已读]
```

## ✅ 成功标志

如果以下3项都符合，说明派发功能工作正常：

1. ✅ 控制台显示完整的派发日志（包含emoji图标）
2. ✅ "我的任务"中出现新派发的任务
3. ✅ 页面顶部显示任务派发通知

## ⚠️ 注意事项

### 前提条件
- 应用必须有子任务
- 子任务状态应该是"研发进行中"或"业务上线中"（不能是"待启动"或"已完成"）

### 任务显示规则
只有符合以下条件的子任务才会在"我的任务"中显示：
- 状态为"研发进行中"、"业务上线中"或"存在阻塞"
- `dev_owner` 或 `ops_owner` 匹配当前用户名（测试管理员）

### 如果看不到任务
1. 检查控制台，确认子任务确实被更新了
2. 点击"刷新"按钮手动刷新
3. 检查子任务状态是否符合显示条件
4. 查看"全部"、"研发中"、"上线中"等不同标签

## 📊 当前配置

- **Mock模式**: ✅ 已启用（前端直接更新数据）
- **当前用户**: 测试管理员 (TEST001)
- **自动刷新**: 每30秒
- **通知类型**: in_app (应用内通知)

## 📖 完整文档

详细测试指南和故障排查，请查看：
- `docs/DISPATCH_TEST_GUIDE.md` - 完整测试指南
- `docs/DISPATCH_FEATURE_SUMMARY.md` - 功能总结
- `docs/DISPATCH_INTEGRATION_GUIDE.md` - 集成指南
